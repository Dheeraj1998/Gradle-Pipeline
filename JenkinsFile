pipeline {
	agent any 
		stages {
			stage ("Clean"){
				steps {
					echo 'Cleaning step.'
					sh './gradlew clean --no-daemon'
				}
			}

			stage ("Build"){
				steps {
					echo 'Building step.'
					sh './gradlew build --no-daemon'
				}
			}

			stage ("CheckMarx"){
				steps {
					echo 'Applying CheckMarx plugin.'
					step(
						[$class: 'CxScanBuilder', 
						comment: '', 
						credentialsId: '', 
						excludeFolders: '', 
						excludeOpenSourceFolders: '', 
						exclusionsSetting: 'global', 
						failBuildOnNewResults: false, 
						failBuildOnNewSeverity: 'HIGH', 
						filterPattern: '', 
						fullScanCycle: 10, 
						includeOpenSourceFolders: '', 
						osaArchiveIncludePatterns: '*.zip, *.war, *.ear, *.tgz', 
						osaInstallBeforeScan: false, 
						password: '{AQAAABAAAAAQwPqi9XpXtqXJxU7qD7L7gduFiKYhj41B/MJxvJLEg3U=}', 
						projectName: 'TestPipeline', 
						sastEnabled: true, 
						serverUrl: '', 
						sourceEncoding: 'Provide Checkmarx server credentials to see source encodings list', 
						username: '', 
						vulnerabilityThresholdResult: 'FAILURE', 
						waitForResultsEnabled: true])
				}
			}

			stage ("Test"){
				steps {
					echo 'Testing step.'
				}
			}

			stage ("Deploy"){
				steps {
					echo 'Deploying step.'
				}
			}
		}
	
}